services:
  - mysql
language: php
before_install:
  - mysql -e 'CREATE DATABASE teach;'
  - phpenv config-add travis.php.ini
  - printf "\n" | pecl install imagick
install:
  - composer install
  - "./migrate-database"
  - php ./cli/teach.php regenerateTDBM
php:
  - '7.3'
deploy:
  provider: script
  script: curl https://teach.local.pulledbits.org/update.php
  on:
    branch: master